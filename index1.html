<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Exoplanet Habitability Predictor</title>

    <style>
        body {
            font-family: Arial, sans-serif;
            background: radial-gradient(circle at top, #0f2027, #203a43, #2c5364);
            color: white;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 900px;
            margin: auto;
            padding: 30px;
        }

        h1 {
            text-align: center;
            margin-bottom: 10px;
        }

        p {
            text-align: center;
            opacity: 0.9;
        }

        .card {
            background: rgba(255, 255, 255, 0.08);
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
        }

        label {
            display: block;
            margin-top: 12px;
        }

        input {
            width: 100%;
            padding: 8px;
            margin-top: 4px;
            border-radius: 6px;
            border: none;
        }

        button {
            width: 100%;
            padding: 12px;
            margin-top: 20px;
            border: none;
            border-radius: 8px;
            background: #00c6ff;
            color: black;
            font-size: 16px;
            cursor: pointer;
            font-weight: bold;
        }

        button:hover {
            background: #00a3d6;
        }

        #result {
            text-align: center;
            margin-top: 20px;
            font-size: 18px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        th, td {
            border: 1px solid rgba(255,255,255,0.3);
            padding: 8px;
            text-align: center;
        }

        th {
            background: rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>

<div class="container">
    <h1>üåç Exoplanet Habitability Predictor</h1>
    <p>Enter planet & star values to predict habitability</p>

    
    <div class="card">
        <h2>üîÆ Predict Habitability</h2>

        <label>Planet Radius (Earth radii)</label>
        <input id="pl_rade" type="number" step="0.01" value="1.0">

        <label>Planet Mass (Earth masses)</label>
        <input id="pl_bmasse" type="number" step="0.01" value="1.0">

        <label>Equilibrium Temperature (K)</label>
        <input id="pl_eqt" type="number" step="1" value="288">

        <label>Orbital Period (days)</label>
        <input id="pl_orbper" type="number" step="1" value="365">

        <label>Star Temperature (K)</label>
        <input id="st_teff" type="number" step="10" value="5778">

        <label>Star Radius (Solar radii)</label>
        <input id="st_rad" type="number" step="0.01" value="1.0">

        <button onclick="predict()">Predict</button>

        <div id="result"></div>
    </div>

    
    <div class="card">
        <h2>üèÜ Top 10 Ranked Planets</h2>
        <button onclick="loadRanks()">Load Rankings</button>
        <div id="rankings"></div>
    </div>
</div>

<script>
const api = "http://127.0.0.1:5000";

async function predict() {

    // Always read values fresh
    const data = {
        pl_rade: parseFloat(document.getElementById("pl_rade").value),
        pl_bmasse: parseFloat(document.getElementById("pl_bmasse").value),
        pl_eqt: parseFloat(document.getElementById("pl_eqt").value),
        pl_orbper: parseFloat(document.getElementById("pl_orbper").value),
        st_teff: parseFloat(document.getElementById("st_teff").value),
        st_rad: parseFloat(document.getElementById("st_rad").value)
    };

    // Validation
    for (let k in data) {
        if (isNaN(data[k])) {
            alert("Please enter valid numbers in all fields");
            return;
        }
    }

    const res = await fetch(api + "/predict", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
    });

    const r = await res.json();
    console.log("API RESPONSE:", r);

    // CORRECT FIELD NAME
    const percent = (r.habitability_probability * 100).toFixed(2);

    document.getElementById("result").innerHTML = `
        <h3>${r.habitability === 1 ? "üåç Habitable" : "Not Habitable"}</h3>
        <p>Probability: <b>${percent}%</b></p>
    `;
}


async function loadRanks() {
    const res = await fetch(api + "/rank");
    const data = await res.json();

    let html = `<table>
        <tr>
            <th>Rank</th>
            <th>Planet</th>
            <th>Score</th>
        </tr>`;

    data.forEach(p => {
        html += `
        <tr>
            <td>${p.rank}</td>
            <td>${p.planet_name}</td>
            <td>${p.habitability_score.toFixed(4)}</td>
        </tr>`;
    });

    html += "</table>";
    document.getElementById("rankings").innerHTML = html;
}
</script>

</body>
</html>
